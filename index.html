<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Pedido Sircom</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background: #f8f8f8;
      color: #333;
      padding: 30px;
      max-width: 600px;
      margin: auto;
    }

    h1 {
      color: #0078ae;
      text-align: center;
    }

    form {
        background-color: #fff;
        padding: 25px;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    label {
      font-weight: bold;
      display: block;
      margin: 15px 0 5px;
    }

    select, input[type="number"], input[type="text"] {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box; /* Importante para que el padding no afecte el ancho */
    }

    .precio {
      font-size: 1.5em;
      margin-top: 25px;
      font-weight: bold;
      color: #0078ae;
      text-align: right;
    }

    button {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 12px 20px;
      margin-top: 20px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1.1em;
      width: 100%;
    }

    button:hover {
      background-color: #218838;
    }

    /* Estilo para ocultar opciones */
    .hidden {
        display: none;
    }

  </style>
</head>
<body>

  <h1>Formulario de Pedido</h1>

  <form id="pedidoForm" name="pedido">
    <label for="tipoServicio">Tipo de Servicio:</label>
    <select id="tipoServicio" name="servicio" required>
      <option value="">Selecciona un servicio</option>
      <option value="impresion_laser">Impresión Láser</option>
      <option value="plotteo_tinta">Ploteo Tinta (Epson T7200)</option>
      <option value="plotteo_laser">Ploteo Láser (MP 3601)</option>
    </select>

    <div id="opcionesImpresionLaser" class="hidden">
        <label for="tipoColorLaser">Tipo de Color:</label>
        <select id="tipoColorLaser" name="tipoColor">
            <option value="bn">Blanco y Negro</option>
            <option value="color">Color</option>
        </select>

        <label for="papelLaser">Tipo de Papel:</label>
        <select id="papelLaser" name="papel">
            <option value="bond">Bond</option>
            <option value="couche">Couché</option>
            <option value="opalina">Opalina</option>
            <option value="adhesivo">Adhesivo</option>
            <option value="vegetal">Vegetal</option>
        </select>
        
        <label for="tamanoLaser">Tamaño:</label>
        <select id="tamanoLaser" name="tamano">
            <option value="carta">Carta</option>
            <option value="oficio">Oficio</option>
            <option value="doble_carta">Doble Carta (Tabloide)</option>
            <option value="doble_oficio">Doble Oficio</option>
        </select>
    </div>

    <div id="opcionesPlotteo" class="hidden">
        <label for="papelPlotteo">Tipo de Papel:</label>
        <select id="papelPlotteo" name="papel">
            </select>
    </div>

    <label for="cantidad">Cantidad:</label>
    <input type="number" id="cantidad" name="cantidad" min="1" value="1" required>

    <p class="precio">Total: $<span id="total">0</span> CLP</p>

    <button type="submit">Agregar al Carrito</button>
  </form>

  <script>
    const precios = {
      impresion_laser: {
        bn: {
          bond: { carta: 55, oficio: 50 },
          couche: { carta: 127, doble_carta: 263, doble_oficio: 1063 },
          opalina: { carta: 139, doble_carta: 270, doble_oficio: 1063 },
          adhesivo: { carta: 177, doble_carta: 393 },
          vegetal: { carta: 197, doble_carta: 243 }
        },
        color: {
          bond: { carta: 125, oficio: 129 },
          couche: { carta: 197, doble_carta: 394, doble_oficio: 1310 },
          opalina: { carta: 209, doble_carta: 411, doble_oficio: 1310 },
          adhesivo: { carta: 247, doble_carta: 534 },
          vegetal: { carta: 267, doble_carta: 384 }
        }
      },
      plotteo_tinta: { // Epson T7200
        bond: 1150,
        poliester: 6400,
        mate: 9020,
        semi_glossy: 11000
      },
      plotteo_laser: { // MP 3601 (Solo Negro)
        bond: 970,
        poliester: 5370
      }
    };

    // --- Elementos del DOM ---
    const form = document.getElementById('pedidoForm');
    const totalDisplay = document.getElementById('total');
    const tipoServicioSelect = document.getElementById('tipoServicio');
    
    const opcionesImpresionLaser = document.getElementById('opcionesImpresionLaser');
    const opcionesPlotteo = document.getElementById('opcionesPlotteo');
    
    const papelPlotteoSelect = document.getElementById('papelPlotteo');

    // --- Lógica de actualización ---
    
    tipoServicioSelect.addEventListener('change', function() {
        // Ocultar todas las opciones primero
        opcionesImpresionLaser.classList.add('hidden');
        opcionesPlotteo.classList.add('hidden');
        
        const servicio = this.value;

        if (servicio === 'impresion_laser') {
            opcionesImpresionLaser.classList.remove('hidden');
        } else if (servicio === 'plotteo_tinta' || servicio === 'plotteo_laser') {
            opcionesPlotteo.classList.remove('hidden');
            // Llenar las opciones de papel para plotteo dinámicamente
            papelPlotteoSelect.innerHTML = ''; // Limpiar opciones anteriores
            const papelesDisponibles = Object.keys(precios[servicio]);
            
            papelesDisponibles.forEach(papel => {
                const option = document.createElement('option');
                option.value = papel;
                // Formatear el nombre para mostrar (ej: semi_glossy -> Semi Glossy)
                option.textContent = papel.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                papelPlotteoSelect.appendChild(option);
            });
        }
        calcularTotal();
    });

    function calcularTotal() {
        const servicio = tipoServicioSelect.value;
        const cantidad = parseInt(document.getElementById('cantidad').value) || 0;
        let precioUnitario = 0;

        if (servicio === 'impresion_laser') {
            const tipoColor = document.getElementById('tipoColorLaser').value;
            const papel = document.getElementById('papelLaser').value;
            const tamano = document.getElementById('tamanoLaser').value;
            precioUnitario = precios.impresion_laser?.[tipoColor]?.[papel]?.[tamano] || 0;

        } else if (servicio === 'plotteo_tinta' || servicio === 'plotteo_laser') {
            const papel = papelPlotteoSelect.value;
            precioUnitario = precios[servicio]?.[papel] || 0;
        }

        let total = precioUnitario * cantidad;
        totalDisplay.textContent = total.toLocaleString('es-CL');
    }

    // Escuchar cambios en cualquier input o select del formulario
    form.addEventListener('input', calcularTotal);

    // Simulación de envío
    form.addEventListener('submit', function (e) {
      e.preventDefault();
      const totalFinal = totalDisplay.textContent;
      if (parseFloat(totalFinal.replace(/\./g, '')) > 0) {
        alert(`Producto agregado al carrito (simulado).\nTotal: $${totalFinal} CLP`);
      } else {
        alert("Por favor, selecciona una combinación de producto válida para ver un precio.");
      }
    });

    // Iniciar el cálculo al cargar la página
    calcularTotal();

  </script>

</body>
</html>